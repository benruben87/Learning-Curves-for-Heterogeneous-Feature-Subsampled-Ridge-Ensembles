(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51077,       1391]
NotebookOptionsPosition[     46619,       1316]
NotebookOutlinePosition[     47031,       1332]
CellTagsIndexPosition[     46988,       1329]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Optimal Regularization ", "Text",
 CellChangeTimes->{{3.9061389548936424`*^9, 
  3.9061389593180304`*^9}},ExpressionUUID->"9ad7bd7a-f1a4-4273-832d-\
c7397fb065a4"],

Cell["First solve the saddle-point equations for qhat. ", "Text",
 CellChangeTimes->{{3.9047552232124*^9, 3.9047552439174566`*^9}, {
  3.906138946358408*^9, 
  3.906138947644535*^9}},ExpressionUUID->"b9ebf42e-6dd9-4f3c-816e-\
7601eea5c30a"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "q", ",", " ", "qp", ",", " ", "qhat", ",", " ", "qhatp", ",", " ", "a", 
   ",", " ", "x", ",", " ", "S", ",", " ", "\[Gamma]", ",", " ", "I0", ",", 
   " ", "I1", ",", " ", "F"}], "]"}]], "Input",
 CellChangeTimes->{{3.904765683672065*^9, 3.9047657017119894`*^9}, {
  3.9059128477141743`*^9, 3.905912857613731*^9}, {3.9059129248354588`*^9, 
  3.905912928366479*^9}, {3.906214096946218*^9, 3.906214109339266*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"318774bb-2517-4723-8885-1c03bb4c9fb7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opsolr", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", " ", "==", " ", 
       RowBox[{"a", "*", 
        RowBox[{"\[Nu]", "/", 
         RowBox[{"(", 
          RowBox[{"\[Nu]", "+", 
           RowBox[{"a", "*", "qhat"}]}], ")"}]}]}]}], ",", " ", 
      RowBox[{"qhat", " ", "==", " ", 
       RowBox[{"\[Alpha]", "/", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", "q"}], ")"}]}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "qhat"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9047552457679205`*^9, 3.904755246765437*^9}, {
  3.904755411415664*^9, 3.9047554934553165`*^9}, {3.9047655757960496`*^9, 
  3.9047656065347595`*^9}, {3.905912880674271*^9, 3.905912888115155*^9}, {
  3.905912933854608*^9, 3.905912951198756*^9}, {3.9062141210364532`*^9, 
  3.9062141456657305`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ebf78a7f-c41d-43b2-8562-c8294e7c43d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "\[Alpha]"}], "+", 
        RowBox[{"a", " ", "\[Nu]"}], "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "a", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[Alpha]"}], "-", 
             RowBox[{"a", " ", "\[Nu]"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "\[Nu]"}]]}], ",", 
     RowBox[{"qhat", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"a", " ", "\[Alpha]"}], "-", 
        RowBox[{"a", " ", "\[Nu]"}], "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "a", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[Alpha]"}], "-", 
             RowBox[{"a", " ", "\[Nu]"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "a", " ", "\[Lambda]"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "\[Alpha]"}], "+", 
        RowBox[{"a", " ", "\[Nu]"}], "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "a", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[Alpha]"}], "-", 
             RowBox[{"a", " ", "\[Nu]"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "\[Nu]"}]]}], ",", 
     RowBox[{"qhat", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"a", " ", "\[Alpha]"}], "-", 
        RowBox[{"a", " ", "\[Nu]"}], "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "a", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "\[Alpha]"}], "-", 
             RowBox[{"a", " ", "\[Nu]"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "a", " ", "\[Lambda]"}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.906727178377207*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"1d8536f8-d6a5-46b4-ba0e-0984647bf1d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xvalr", " ", "=", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"4", " ", "a", " ", "\[Lambda]", " ", 
      SuperscriptBox["\[Nu]", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "\[Alpha]"}], "-", 
        RowBox[{"a", " ", "\[Nu]"}], "+", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"qhat", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "/", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", "+", "q"}], ")"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{"q", " ", "->", 
      RowBox[{"opsolr", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9047555316063757`*^9, 3.9047555435130453`*^9}, 
   3.9047566086866703`*^9, {3.9047655924948378`*^9, 3.904765680239786*^9}, {
   3.904765715082162*^9, 3.904765718903921*^9}, {3.905912959842702*^9, 
   3.9059129809652367`*^9}, {3.9062141641172624`*^9, 3.9062141939561205`*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"f9f60ba8-bef6-4cb6-8121-09d33b673bd4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Alpha]", " ", "\[Nu]"}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "a"}], " ", "\[Alpha]"}], "+", 
   RowBox[{"a", " ", "\[Nu]"}], "+", 
   RowBox[{"\[Lambda]", " ", "\[Nu]"}], "+", 
   SqrtBox[
    RowBox[{
     RowBox[{"4", " ", "a", " ", "\[Lambda]", " ", 
      SuperscriptBox["\[Nu]", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}]}], "+", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}]]], "Output",
 CellChangeTimes->{
  3.904755548552395*^9, 3.904756684523346*^9, {3.9047657088730907`*^9, 
   3.904765719189103*^9}, 3.9047728081483045`*^9, 3.906214199034132*^9, 
   3.906220038943844*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"43984f02-3a9a-422a-a4bc-44a1776c03e2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"qhat", "/", 
       RowBox[{"(", 
        RowBox[{"\[Nu]", "+", 
         RowBox[{"a", "*", "qhat"}]}], ")"}]}]}], ";", " ", 
     RowBox[{
      RowBox[{"Don", "'"}], "t", " ", "define", " ", "S", " ", "yet"}]}], ",",
     " ", 
    RowBox[{"first", " ", "solve", " ", "for", " ", 
     RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "S", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "\[Alpha]"}], "*", 
      RowBox[{"a", "^", "2"}], " ", "\[Nu]", " ", 
      RowBox[{"S", "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I0", " ", "=", " ", 
     RowBox[{"s", 
      RowBox[{"(", 
       RowBox[{"1", "-", "c"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "*", "s", 
         RowBox[{"(", 
          RowBox[{"1", "-", "c"}], ")"}], "\[Nu]", "*", "S"}], "+", " ", 
        RowBox[{"a", " ", "s", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "c"}], ")"}], "\[Nu]", "  ", 
         RowBox[{"S", "^", "2"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I1", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"s", 
         RowBox[{"(", 
          RowBox[{"1", "-", "c"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}]}], "+", 
        RowBox[{"\[Omega]", "^", "2"}]}], ")"}], "/", "\[Nu]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Gamma]"}], ")"}]}], "*", " ", 
       RowBox[{"a", "^", "2"}], " ", 
       RowBox[{"\[Nu]", "/", "\[Alpha]"}], " ", "*", " ", "S", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Rho]", "^", "2"}]}], ")"}], "*", "I0"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"\[Rho]", "^", "2"}], "*", "I1"}], " ", "+", " ", 
         RowBox[{"\[Zeta]", "^", "2"}], " ", "+", " ", 
         RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Rho]", "^", "2"}]}], ")"}], "*", 
       RowBox[{"s", "^", "2"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "c"}], ")"}], "^", "2"}], "\[Nu]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "S"}], "-", "1"}], ")"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9047484514354153`*^9, 3.9047484804416885`*^9}, {
  3.9047485206436796`*^9, 3.9047486649979467`*^9}, {3.904748702490324*^9, 
  3.9047488728575373`*^9}, {3.904755649406244*^9, 3.904755657185297*^9}, {
  3.904755691213961*^9, 3.9047557726091275`*^9}, {3.90475988211384*^9, 
  3.904759889928425*^9}, {3.9047657267442336`*^9, 3.9047657270325975`*^9}, {
  3.9047725804941077`*^9, 3.90477259909842*^9}, {3.9047727195218954`*^9, 
  3.9047727199861927`*^9}, {3.906214591799347*^9, 3.9062146181441574`*^9}, {
  3.906220017642909*^9, 3.9062200177897377`*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"701698cd-1021-49ea-a23a-1db5eb1866c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", " ", "=", " ", 
  RowBox[{"Simplify", "[", "F", "]"}]}]], "Input",
 CellChangeTimes->{{3.904755664214469*^9, 3.9047556675262895`*^9}, {
  3.9047558439858875`*^9, 3.904755844424242*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"3d8d77fb-96ee-4c11-8d6a-47049e752e13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"]}], " ", 
   SuperscriptBox["s", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"a", " ", "S"}]}], ")"}], " ", "\[Nu]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", "S", " ", "\[Nu]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Zeta]", "2"], "+", 
      SuperscriptBox["\[Eta]", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "c"}], ")"}], " ", "s", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", "S", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"a", " ", "S"}]}], ")"}], " ", "\[Nu]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}]}], "+", 
          SuperscriptBox["\[Omega]", "2"]}], ")"}]}], "\[Nu]"]}], ")"}]}], 
   RowBox[{"\[Alpha]", "-", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["S", "2"], " ", "\[Nu]"}]}]]}]], "Output",
 CellChangeTimes->{3.9047556789798155`*^9, 3.904755794550632*^9, 
  3.9047558560109787`*^9, 3.904756690669967*^9, 3.9047657573908386`*^9, 
  3.904772810345873*^9, 3.906214573567872*^9, 3.9062146209861636`*^9, 
  3.9062200452353125`*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"bf564ba9-28d6-4f2e-84d8-0e3dc9625e7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Gamma]"}], ")"}]}], "*", "F"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "1"}], ")"}], "*", 
      RowBox[{"s", "^", "2"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "c"}], ")"}], "^", "2"}], "*", "\[Nu]", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Rho]", "^", "2"}]}], ")"}]}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9062144545729475`*^9, 3.906214522583515*^9}, {
  3.9062147420653057`*^9, 3.9062147618322554`*^9}, {3.9062151819735837`*^9, 
  3.9062151941406236`*^9}, {3.906215344991*^9, 3.906215348645033*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"593080fd-f1a4-40cf-9a7d-ec3eccd4005f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["S", "2"], " ", "\[Nu]"}]}], ")"}], "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", "k", " ", 
     SuperscriptBox["s", "2"], " ", 
     SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "-", 
    RowBox[{"a", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
     SuperscriptBox["s", "2"], " ", "S", " ", 
     SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
     SuperscriptBox["s", "2"], " ", 
     SuperscriptBox["S", "4"], " ", 
     SuperscriptBox["\[Nu]", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", "S", " ", "\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Zeta]", "2"], " ", "\[Nu]"}], "+", 
       RowBox[{
        SuperscriptBox["\[Eta]", "2"], " ", "\[Nu]"}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", "k"}]}], ")"}], " ", 
        SuperscriptBox["s", "2"], " ", "S", " ", 
        SuperscriptBox["\[Nu]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Rho]", "2"]}], "+", 
          RowBox[{"\[Nu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Rho]", "2"], " ", 
        SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.90621455987444*^9, 3.906214625677573*^9, {3.9062151850357776`*^9, 
   3.9062151947642064`*^9}, 3.90621534922808*^9, 3.906220047968747*^9},
 CellLabel->
  "Out[352]=",ExpressionUUID->"bcea23fa-b3f5-4ab6-bde4-69120574de62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", " ", "=", " ", 
  RowBox[{"G", "*", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["S", "2"], " ", "\[Nu]"}]}], ")"}], "2"]}]}]], "Input",
 CellChangeTimes->{{3.906215383444654*^9, 3.906215400500968*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"1600e015-e97e-490a-bcbf-c7b5ac21c471"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", "k", " ", 
   SuperscriptBox["s", "2"], " ", 
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "-", 
  RowBox[{"a", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
   SuperscriptBox["s", "2"], " ", "S", " ", 
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["a", "4"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
   SuperscriptBox["s", "2"], " ", 
   SuperscriptBox["S", "4"], " ", 
   SuperscriptBox["\[Nu]", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", "S", " ", "\[Alpha]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Zeta]", "2"], " ", "\[Nu]"}], "+", 
     RowBox[{
      SuperscriptBox["\[Eta]", "2"], " ", "\[Nu]"}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{"2", " ", "k"}]}], ")"}], " ", 
      SuperscriptBox["s", "2"], " ", "S", " ", 
      SuperscriptBox["\[Nu]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[Rho]", "2"]}], "+", 
        RowBox[{"\[Nu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[Rho]", "2"], " ", 
      SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.906215401571085*^9, 3.9062200493545475`*^9},
 CellLabel->
  "Out[353]=",ExpressionUUID->"0422ff5b-2858-4527-be19-e6e66ac0b696"]
}, Open  ]],

Cell["\<\
S is the positive real root of this quartic polynomial.  Best to solve for \
this numerically.  We can recover the solution already obtained in the case \
where k=1\
\>", "Text",
 CellChangeTimes->{{3.9062159534245725`*^9, 3.906215983176375*^9}, {
  3.9062163323946877`*^9, 
  3.9062163422362146`*^9}},ExpressionUUID->"2a78467f-9ea4-4c19-97de-\
24d2d37a2474"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sk1", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"H", "/.", 
          RowBox[{"{", 
           RowBox[{"k", "->", "1"}], "}"}]}], ")"}], "==", "0"}], ",", " ", 
       "S"}], "]"}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9062163438357573`*^9, 3.9062164145094256`*^9}, {
  3.9062164830878024`*^9, 3.906216487365589*^9}, {3.906216560312729*^9, 
  3.9062165865110145`*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"236b56be-2cf4-49df-a96a-e650bd23f8c0"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
     SuperscriptBox["s", "2"], " ", 
     SuperscriptBox["\[Nu]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[Rho]", "2"]}], ")"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", "s", " ", "\[Nu]"}], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", "c", " ", "s", " ", "\[Nu]"}], "+", 
     RowBox[{"a", " ", 
      SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]"}], "-", 
     RowBox[{"2", " ", "a", " ", "c", " ", 
      SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]"}], "+", 
     RowBox[{"a", " ", 
      SuperscriptBox["c", "2"], " ", 
      SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]"}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[Zeta]", "2"], " ", "\[Nu]"}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[Eta]", "2"], " ", "\[Nu]"}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", "s", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", "c", " ", "s", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", "s", " ", "\[Nu]", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", "c", " ", "s", " ", "\[Nu]", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "+", 
     RowBox[{"2", " ", "a", " ", "c", " ", 
      SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["c", "2"], " ", 
      SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]", " ", 
      SuperscriptBox["\[Rho]", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[Rho]", "2"], " ", 
      SuperscriptBox["\[Omega]", "2"]}], "-", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "c"}], ")"}], "4"], " ", 
           SuperscriptBox["s", "4"], " ", "\[Alpha]", " ", 
           SuperscriptBox["\[Nu]", "3"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
              SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", "\[Nu]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "-", 
             RowBox[{"a", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Zeta]", "2"], " ", "\[Nu]"}], "+", 
                RowBox[{
                 SuperscriptBox["\[Eta]", "2"], " ", "\[Nu]"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["\[Rho]", "2"]}], "+", 
                   RowBox[{"\[Nu]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{
                 SuperscriptBox["\[Rho]", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}], 
           "2"]}], ")"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9062163630866013`*^9, 3.9062164410314693`*^9}, 
   3.906216495646638*^9, {3.9062165491008024`*^9, 3.9062165889694614`*^9}, 
   3.906220054720333*^9},
 CellLabel->
  "Out[354]=",ExpressionUUID->"6e0683f2-934e-47fd-ac56-cf2d74164df9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ssols", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"H", "==", "0"}], ",", " ", "S"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.906216833875809*^9, 3.9062168558964386`*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"b9006428-e777-4996-a005-da3766768090"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{"{", 
           RowBox[{"S", "\[Rule]", 
             RowBox[{
               RowBox[{
                 FractionBox["1", "2"], " ", 
                 SqrtBox[
                  RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"3", " ", "\[Alpha]"}], "-", 
                    RowBox[{"2", " ", "k", " ", "\[Alpha]"}]}], 
                    RowBox[{
                    SuperscriptBox["a", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "\[Nu]"}]]}], 
                    "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], " ", 
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", 
                    SuperscriptBox["\[Nu]", "2"]}], "+", 
                    TemplateBox[{"13"}, "OutputSizeLimit`Skeleton"], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["a", "2"], " ", "c", " ", "k", " ", 
                    SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", 
                    SuperscriptBox["\[Nu]", "2"], " ", 
                    SuperscriptBox["\[Rho]", "2"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["a", "2"], " ", 
                    SuperscriptBox["c", "2"], " ", "k", " ", 
                    SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", 
                    SuperscriptBox["\[Nu]", "2"], " ", 
                    SuperscriptBox["\[Rho]", "2"]}]}], 
                    RowBox[{"3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["a", "4"], " ", 
                    SuperscriptBox["s", "2"], " ", 
                    SuperscriptBox["\[Nu]", "3"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["a", "4"], " ", "c", " ", 
                    SuperscriptBox["s", "2"], " ", 
                    SuperscriptBox["\[Nu]", "3"]}], "+", 
                    TemplateBox[{"14"}, "OutputSizeLimit`Skeleton"], "+", 
                    RowBox[{
                    SuperscriptBox["a", "4"], " ", 
                    SuperscriptBox["c", "2"], " ", "k", " ", 
                    SuperscriptBox["s", "2"], " ", 
                    SuperscriptBox["\[Nu]", "3"], " ", 
                    SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]], "+", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["2", 
                    RowBox[{"1", "/", "3"}]], " ", 
                    TemplateBox[{"5"}, "OutputSizeLimit`Skeleton"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[Rho]", "2"]}], ")"}]}], 
                    RowBox[{"3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}], 
                    RowBox[{"1", "/", "3"}]]}]], "+", 
                    FractionBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}], 
                    "3"]}], "-", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "+", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "+", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    SuperscriptBox[
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "3"]}], 
                    "+", 
                    SuperscriptBox[
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "2"]}]]}],
                     ")"}], 
                    RowBox[{"1", "/", "3"}]], 
                    RowBox[{"3", " ", 
                    SuperscriptBox["2", 
                    RowBox[{"1", "/", "3"}]], " ", 
                    SuperscriptBox["a", "4"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    SuperscriptBox["s", "2"], " ", 
                    SuperscriptBox["\[Nu]", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[Rho]", "2"]}], ")"}]}]]}]]}], "-", 
               RowBox[{
                 FractionBox["1", "2"], " ", 
                 SqrtBox[
                  TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]]}]}]}], 
           "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"S", "\[Rule]", 
             RowBox[{
               TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "+", 
               TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]}]}], "}"}], ",", 
         TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ",", 
         RowBox[{"{", 
           RowBox[{"S", "\[Rule]", 
             RowBox[{
               RowBox[{
                 RowBox[{"-", 
                   FractionBox["1", "2"]}], " ", 
                 SqrtBox[
                  TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]]}], "+", 
               RowBox[{
                 FractionBox["1", "2"], " ", 
                 SqrtBox[
                  TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]]}]}]}], 
           "}"}]}], "}"}], Short[#, 5]& ], "line" -> 355, "sessionID" -> 
   24769213171519022549, "byteCount" -> 1652360, "size" -> 5, "stored" -> 
   False, "expr" -> Missing["NotAvailable", "NewSessionID"], "wrap" -> 
   OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{3.9062170175418077`*^9, 3.906220064261881*^9},
 CellLabel->
  "Out[355]=",ExpressionUUID->"41c266cc-31c8-4e62-a844-b038377c10ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"H", ",", " ", 
   RowBox[{"{", 
    RowBox[{"S", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9062160089461956`*^9, 3.906216023115713*^9}, {
  3.9062161180370727`*^9, 3.9062161225529447`*^9}, {3.906216238678674*^9, 
  3.9062162389959874`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"e816674c-cd8a-44b2-875e-988488a0c1d7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", "k", " ", 
    SuperscriptBox["s", "2"], " ", 
    SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "a"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
       SuperscriptBox["s", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Zeta]", "2"], " ", "\[Nu]"}], "+", 
         RowBox[{
          SuperscriptBox["\[Eta]", "2"], " ", "\[Nu]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[Rho]", "2"]}], "+", 
            RowBox[{"\[Nu]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], " ", 
          SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}], " ", "S"}], 
   "-", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"2", " ", "k"}]}], ")"}], " ", 
    SuperscriptBox["s", "2"], " ", "\[Alpha]", " ", 
    SuperscriptBox["\[Nu]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", 
    SuperscriptBox["S", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["a", "4"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
    SuperscriptBox["s", "2"], " ", 
    SuperscriptBox["\[Nu]", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", 
    SuperscriptBox["S", "4"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "S", "]"}], "6"],
    SeriesData[$CellContext`S, 0, {}, 0, 6, 1],
    Editable->False]}],
  SeriesData[$CellContext`S, 
   0, {(-1 + $CellContext`c)^2 $CellContext`k $CellContext`s^2 $CellContext`\
\[Alpha]^2 $CellContext`\[Nu] (-1 + $CellContext`\[Rho]^2), -$CellContext`a \
(-1 + $CellContext`c)^2 $CellContext`s^2 $CellContext`\[Alpha]^2 \
$CellContext`\[Nu] (-1 + $CellContext`\[Rho]^2) + $CellContext`a^2 \
$CellContext`\[Alpha] ($CellContext`\[Zeta]^2 $CellContext`\[Nu] + \
$CellContext`\[Eta]^2 $CellContext`\[Nu] + (-1 + $CellContext`c) \
$CellContext`s (-$CellContext`\[Rho]^2 + $CellContext`\[Nu] (-1 + 
          2 $CellContext`\[Rho]^2)) + $CellContext`\[Rho]^2 $CellContext`\
\[Omega]^2), -$CellContext`a^2 (-1 + $CellContext`c)^2 (-3 + 
     2 $CellContext`k) $CellContext`s^2 $CellContext`\[Alpha] $CellContext`\
\[Nu]^2 (-1 + $CellContext`\[Rho]^2), 
    0, $CellContext`a^4 (-1 + $CellContext`c)^2 (-1 + $CellContext`k) \
$CellContext`s^2 $CellContext`\[Nu]^3 (-1 + $CellContext`\[Rho]^2)}, 0, 6, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.906216017568334*^9, 3.906216023653384*^9}, 
   3.9062161232567697`*^9, 3.9062162394586086`*^9, 3.906220064487378*^9},
 CellLabel->
  "Out[356]=",ExpressionUUID->"7a61e883-6d58-4939-bda9-e6edd80ee51e"]
}, Open  ]],

Cell["Put polynomial\[CloseCurlyQuote]s coefficients into variables.", "Text",
 CellChangeTimes->{{3.90621698579237*^9, 
  3.9062169952880926`*^9}},ExpressionUUID->"0a0b06b4-652d-4acd-9c9c-\
3b3404369d68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SsolsC", " ", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"C1", "+", 
       RowBox[{"C2", "*", "S"}], "+", 
       RowBox[{"C2", "*", 
        RowBox[{"S", "^", "2"}]}], "+", 
       RowBox[{"C4", "*", 
        RowBox[{"S", "^", "4"}]}]}], " ", "==", " ", "0"}], ",", " ", "S"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9062169621431427`*^9, 3.906217051058342*^9}, {
   3.906217082764497*^9, 3.9062171074021816`*^9}, 3.90621715520899*^9, 
   3.906217203654727*^9},
 CellLabel->
  "In[357]:=",ExpressionUUID->"50243376-252a-436e-87b4-37b3426bbb7f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9062170108007298`*^9, 
  3.9062170117366185`*^9}},ExpressionUUID->"f9117519-da23-4f71-975b-\
0decaa064e9a"],

Cell["Now, to get optimal regularization from the value of S, put", "Text",
 CellChangeTimes->{{3.90621621897119*^9, 
  3.906216274354261*^9}},ExpressionUUID->"5429df47-f0e6-46da-ab9a-\
9dc5d56620a0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]ofS", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"S", " ", "==", " ", 
      RowBox[{"qhat", "/", 
       RowBox[{"(", 
        RowBox[{"\[Nu]", "+", 
         RowBox[{"a", "*", "qhat"}]}], ")"}]}]}], ",", " ", "\[Lambda]"}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9062162758546085`*^9, 3.906216296085766*^9}, {
  3.9062164521135707`*^9, 3.9062164742062073`*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"0bac0285-fd2b-4659-9e4f-14075800943f"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "nongen", 
   "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 326, 15, 24769213171519022549, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.9062163019339256`*^9, {3.9062164646550217`*^9, 3.9062164745723677`*^9}},
 CellLabel->
  "During evaluation of \
In[326]:=",ExpressionUUID->"12c3d72f-1f02-4fec-9120-a1dc1a47cf85"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"a", " ", "S"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], "+", 
     RowBox[{"a", " ", "S", " ", "\[Nu]"}]}], ")"}]}], 
  RowBox[{"S", " ", "\[Nu]"}]]], "Output",
 CellChangeTimes->{
  3.9062163019663663`*^9, {3.906216464670517*^9, 3.9062164745978184`*^9}},
 CellLabel->
  "Out[326]=",ExpressionUUID->"cfd99f87-6425-4cdb-a6cc-6b98761dbcb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]k1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"\[Lambda]ofS", "/.", 
     RowBox[{"{", 
      RowBox[{"S", "->", "Sk1"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9062166275316753`*^9, 3.906216685207571*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"84043967-1f5f-499e-b17b-8b531905f70b"],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Zeta]", "2"], " ", "\[Nu]"}], "+", 
        RowBox[{
         SuperscriptBox["\[Eta]", "2"], " ", "\[Nu]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c"}], ")"}], " ", "s", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[Rho]", "2"]}], "+", 
           RowBox[{"\[Nu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[Rho]", "2"], " ", "\[Omega]"}]}], ")"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "c"}], ")"}], "2"], " ", 
      SuperscriptBox["s", "2"], " ", 
      SuperscriptBox["\[Nu]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Rho]", "2"]}], ")"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9062166627889977`*^9, 3.906216705523261*^9},
 CellLabel->
  "Out[332]=",ExpressionUUID->"015ce474-4851-4344-9791-9979c321a68c"]
}, Open  ]],

Cell["\<\
This recovers the correct answer for k=1!  Note that it does not depend on \
\[Alpha].\
\>", "Text",
 CellChangeTimes->{{3.9062167927587285`*^9, 
  3.906216816727109*^9}},ExpressionUUID->"6e23aee3-f7dc-45c3-9ede-\
71e26972e9fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]Ssol1", " ", "=", " ", 
  RowBox[{"\[Lambda]ofS", "/.", 
   RowBox[{"{", 
    RowBox[{"S", "->", 
     RowBox[{"Ssols", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1", ",", " ", "2"}], "]"}], "]"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.906217601037696*^9, 3.906217612029766*^9}, {
  3.9062176543689623`*^9, 3.9062176584544315`*^9}, {3.906218192037374*^9, 
  3.906218194480812*^9}},ExpressionUUID->"d7d1cf7a-4266-48cc-800b-\
346de8d1f9c5"],

Cell[BoxData[
 TemplateBox[{
  "Simplify", "time", 
   "\"Time spent on a transformation exceeded \
\\!\\(\\*RowBox[{\\\"300.`\\\"}]\\) seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification.\"", 2, 341, 17, 24769213171519022549, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9062179633739977`*^9},
 CellLabel->
  "During evaluation of \
In[341]:=",ExpressionUUID->"2a5b95ce-1f6b-47a6-ad22-2f70caa9ed52"],

Cell[BoxData[
 TemplateBox[{
  "Simplify", "time", 
   "\"Time spent on a transformation exceeded \
\\!\\(\\*RowBox[{\\\"300.`\\\"}]\\) seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification.\"", 2, 341, 18, 24769213171519022549, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9062182661425734`*^9},
 CellLabel->
  "During evaluation of \
In[341]:=",ExpressionUUID->"bf96cbff-199c-47db-b263-24e9b1b9f45c"],

Cell[BoxData[
 TemplateBox[{
  "Simplify", "time", 
   "\"Time spent on a transformation exceeded \
\\!\\(\\*RowBox[{\\\"300.`\\\"}]\\) seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification.\"", 2, 341, 19, 24769213171519022549, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9062185689383173`*^9},
 CellLabel->
  "During evaluation of \
In[341]:=",ExpressionUUID->"f006a4be-c4d7-4a68-813a-e163f1198397"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Simplify\\\", \
\\\"::\\\", \\\"time\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 341, 20, 24769213171519022549, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.906218568953805*^9},
 CellLabel->
  "During evaluation of \
In[341]:=",ExpressionUUID->"e029f988-2a60-42c5-a40b-1d77919c7054"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9062176529248953`*^9, 3.9062200347615504`*^9},
 CellLabel->
  "Out[341]=",ExpressionUUID->"f8e8f699-b716-4919-b71a-92d43cead4b0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[Lambda]Ssol2", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"\[Lambda]ofS", "/.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Ssols", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", " ", "1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}],
     "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9062176704434648`*^9, 
  3.9062176732699585`*^9}},ExpressionUUID->"f0261b27-70f5-4127-9d95-\
e6e62fc07b07"],

Cell[BoxData[
 RowBox[{"\[Lambda]Ssol3", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"\[Lambda]ofS", "/.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Ssols", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", " ", "1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}],
     "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.90621767920531*^9, 
  3.906217682469252*^9}},ExpressionUUID->"8294df5b-e3f3-4fbf-8ae0-\
d7e1d5e7125f"],

Cell[BoxData[
 RowBox[{"\[Lambda]Ssol4", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"\[Lambda]ofS", "/.", 
     RowBox[{"{", 
      RowBox[{"S", "->", 
       RowBox[{"Ssols", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", " ", "1", ",", " ", "2"}], "]"}], "]"}]}], "}"}]}],
     "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.906217686245472*^9, 
  3.9062176897414303`*^9}},ExpressionUUID->"6be7d30f-44fb-47ec-813b-\
86d8b82b93ba"]
},
WindowSize->{735., 1219.5},
WindowMargins->{{Automatic, -810.75}, {Automatic, -221.25}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e59f6882-a53d-4fd2-a3ac-51e54dfefbf3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 169, 3, 35, "Text",ExpressionUUID->"9ad7bd7a-f1a4-4273-832d-c7397fb065a4"],
Cell[730, 25, 240, 4, 35, "Text",ExpressionUUID->"b9ebf42e-6dd9-4f3c-816e-7601eea5c30a"],
Cell[973, 31, 548, 10, 28, "Input",ExpressionUUID->"318774bb-2517-4723-8885-1c03bb4c9fb7"],
Cell[CellGroupData[{
Cell[1546, 45, 980, 23, 28, "Input",ExpressionUUID->"ebf78a7f-c41d-43b2-8562-c8294e7c43d0"],
Cell[2529, 70, 2870, 79, 183, "Output",ExpressionUUID->"1d8536f8-d6a5-46b4-ba0e-0984647bf1d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5436, 154, 1202, 32, 53, "Input",ExpressionUUID->"f9f60ba8-bef6-4cb6-8121-09d33b673bd4"],
Cell[6641, 188, 872, 24, 55, "Output",ExpressionUUID->"43984f02-3a9a-422a-a4bc-44a1776c03e2"]
}, Open  ]],
Cell[7528, 215, 3331, 88, 143, "Input",ExpressionUUID->"701698cd-1021-49ea-a23a-1db5eb1866c1"],
Cell[CellGroupData[{
Cell[10884, 307, 296, 6, 28, "Input",ExpressionUUID->"3d8d77fb-96ee-4c11-8d6a-47049e752e13"],
Cell[11183, 315, 2084, 62, 93, "Output",ExpressionUUID->"bf564ba9-28d6-4f2e-84d8-0e3dc9625e7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13304, 382, 895, 23, 28, "Input",ExpressionUUID->"593080fd-f1a4-40cf-9a7d-ec3eccd4005f"],
Cell[14202, 407, 3077, 93, 100, "Output",ExpressionUUID->"bcea23fa-b3f5-4ab6-bde4-69120574de62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17316, 505, 413, 11, 31, "Input",ExpressionUUID->"1600e015-e97e-490a-bcbf-c7b5ac21c471"],
Cell[17732, 518, 2579, 82, 78, "Output",ExpressionUUID->"0422ff5b-2858-4527-be19-e6e66ac0b696"]
}, Open  ]],
Cell[20326, 603, 369, 8, 58, "Text",ExpressionUUID->"2a78467f-9ea4-4c19-97de-24d2d37a2474"],
Cell[CellGroupData[{
Cell[20720, 615, 692, 19, 28, "Input",ExpressionUUID->"236b56be-2cf4-49df-a96a-e650bd23f8c0"],
Cell[21415, 636, 4750, 123, 141, "Output",ExpressionUUID->"6e0683f2-934e-47fd-ac56-cf2d74164df9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26202, 764, 301, 7, 28, "Input",ExpressionUUID->"b9006428-e777-4996-a005-da3766768090"],
Cell[26506, 773, 6587, 145, 177, "Output",ExpressionUUID->"41c266cc-31c8-4e62-a844-b038377c10ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33130, 923, 401, 9, 28, "Input",ExpressionUUID->"e816674c-cd8a-44b2-875e-988488a0c1d7"],
Cell[33534, 934, 4074, 111, 78, "Output",ExpressionUUID->"7a61e883-6d58-4939-bda9-e6edd80ee51e"]
}, Open  ]],
Cell[37623, 1048, 205, 3, 35, "Text",ExpressionUUID->"0a0b06b4-652d-4acd-9c9c-3b3404369d68"],
Cell[37831, 1053, 625, 17, 28, "Input",ExpressionUUID->"50243376-252a-436e-87b4-37b3426bbb7f"],
Cell[38459, 1072, 156, 3, 28, "Input",ExpressionUUID->"f9117519-da23-4f71-975b-0decaa064e9a"],
Cell[38618, 1077, 200, 3, 35, "Text",ExpressionUUID->"5429df47-f0e6-46da-ab9a-9dc5d56620a0"],
Cell[CellGroupData[{
Cell[38843, 1084, 598, 16, 28, "Input",ExpressionUUID->"0bac0285-fd2b-4659-9e4f-14075800943f"],
Cell[39444, 1102, 435, 10, 28, "Message",ExpressionUUID->"12c3d72f-1f02-4fec-9120-a1dc1a47cf85"],
Cell[39882, 1114, 489, 15, 48, "Output",ExpressionUUID->"cfd99f87-6425-4cdb-a6cc-6b98761dbcb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40408, 1134, 382, 9, 28, "Input",ExpressionUUID->"84043967-1f5f-499e-b17b-8b531905f70b"],
Cell[40793, 1145, 1395, 42, 58, "Output",ExpressionUUID->"015ce474-4851-4344-9791-9979c321a68c"]
}, Open  ]],
Cell[42203, 1190, 238, 6, 35, "Text",ExpressionUUID->"6e23aee3-f7dc-45c3-9ede-71e26972e9fc"],
Cell[CellGroupData[{
Cell[42466, 1200, 497, 12, 28, "Input",ExpressionUUID->"d7d1cf7a-4266-48cc-800b-346de8d1f9c5"],
Cell[42966, 1214, 511, 11, 46, "Message",ExpressionUUID->"2a5b95ce-1f6b-47a6-ad22-2f70caa9ed52"],
Cell[43480, 1227, 511, 11, 46, "Message",ExpressionUUID->"bf96cbff-199c-47db-b263-24e9b1b9f45c"],
Cell[43994, 1240, 511, 11, 46, "Message",ExpressionUUID->"f006a4be-c4d7-4a68-813a-e163f1198397"],
Cell[44508, 1253, 455, 10, 28, "Message",ExpressionUUID->"e029f988-2a60-42c5-a40b-1d77919c7054"],
Cell[44966, 1265, 186, 3, 32, "Output",ExpressionUUID->"f8e8f699-b716-4919-b71a-92d43cead4b0"]
}, Open  ]],
Cell[45167, 1271, 483, 13, 28, "Input",ExpressionUUID->"f0261b27-70f5-4127-9d95-e6e62fc07b07"],
Cell[45653, 1286, 478, 13, 28, "Input",ExpressionUUID->"8294df5b-e3f3-4fbf-8ae0-d7e1d5e7125f"],
Cell[46134, 1301, 481, 13, 28, "Input",ExpressionUUID->"6be7d30f-44fb-47ec-813b-86d8b82b93ba"]
}
]
*)

